@{
    ViewData["Title"] = "Interview Calendar";
}

<link href="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.8/index.global.min.css" rel="stylesheet" />
<script src="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.8/index.global.min.js"></script>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

<div class="container my-4">
    <h2 class="mb-4">Interview Calendar</h2>

    <div id="calendar"></div>

    <div class="d-flex justify-content-between mt-4">
        <a asp-controller="Interview" asp-action="Schedule" class="btn btn-primary">Schedule Interview</a>
        <form id="cancelForm" method="post" asp-controller="Interview" asp-action="Cancel">
            <input type="hidden" id="cancelInterviewId" name="interview_id" />
            <button type="submit" class="btn btn-danger d-none" id="cancelBtn">Cancel Selected Interview</button>
        </form>
        <a asp-controller="Home" asp-action="Index" class="btn btn-secondary">← Back to Home</a>
    </div>


</div>

<script>
    let selectedEventId = null;

    document.addEventListener('DOMContentLoaded', function () {
        var calendarEl = document.getElementById('calendar');

        var calendar = new FullCalendar.Calendar(calendarEl, {
            initialView: 'timeGridWeek',
            headerToolbar: {
                left: 'prev,next today',
                center: 'title',
                right: 'dayGridMonth,timeGridWeek,timeGridDay'
            },
            slotMinTime: '08:00:00',
            slotMaxTime: '22:00:00',
            nowIndicator: true,
            events: '/Interview/GetInterviews',
            eventColor: '#0d6efd',
            eventDisplay: 'block',
            height: 'auto',
            timeZone: 'local',
            eventClick: function (info) {
                calendar.getEvents().forEach(e => {
                    e.setProp("backgroundColor", "#0d6efd"); 
                });
                info.event.setProp("backgroundColor", "#dc3545"); 

                selectedEventId = info.event.id;
                document.getElementById('cancelInterviewId').value = selectedEventId;
                document.getElementById('cancelBtn').classList.remove("d-none");
            }
        });

        calendar.render();
    });
</script>


<style>
    #calendar {
        max-width: 100%;
        margin: 0 auto;
    }
</style>
